# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Обзор проекта

DevEnv Manager — инструмент для удалённого управления локальными окружениями разработки через Telegram-бот. Позволяет переключаться между проектами и взаимодействовать с Claude Code через Telegram.

## Архитектура

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   Telegram      │────▶│   DevEnv        │────▶│   Claude Code   │
│   Bot API       │◀────│   Manager       │◀────│   SDK           │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                               │
                               ▼
                        ┌─────────────────┐
                        │   Реестр        │
                        │   окружений     │
                        │   (YAML)        │
                        └─────────────────┘
```

## Технологический стек

- Python 3.14
- bot-framework — собственный фреймворк для Telegram-ботов
- claude-code-sdk — взаимодействие с Claude Code
- Redis — управление состоянием (флаги занятости с TTL)
- YAML — реестр окружений

## Дополнительные директории

- `/Users/vladimirsumarokov/dev/smartist/bot_framework` — исходный код bot-framework

## Ключевые особенности

- Запрет параллельных запросов в одном окружении реализуется через Redis
- SDK создаёт независимую сессию для каждого вызова (не блокирует параллельные запросы)
- Клиенты SDK хранятся в памяти для возможности вызова `interrupt()`
- Бот отвечает только пользователям из списка разрешённых ID

## Конфигурация

Секреты хранятся в `.env`:
- Токен Telegram-бота
- Список разрешённых user ID
- URL Redis
- Путь к файлу реестра окружений

Реестр окружений — YAML-файл с описанием проектов (название, описание, путь к директории).

## Статус

Проект в стадии планирования.
